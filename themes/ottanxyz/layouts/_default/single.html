{{ define "header" }}
{{ partial "site-header.html" . }}
{{ end }}

{{ define "description"}}
<meta name="description" content="{{ .Summary }}">
{{ end }}

{{ define "header-description" }}
<meta name="description" content="{{ .Summary }}..." />
<meta property="og:description" content="{{ .Summary }}..." />
<meta name="twitter:description" content="{{ .Summary }}..." />
<meta property="og:type" content="article" />
<meta property="og:article:published_time" content="{{ .Date.Format "2006-01-02T15:04:05Z07:00" | safeHTML}}">
{{ range.Params.tags }}
<meta property="og:article:tag" content="{{ . }}" />
{{ end }}
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@{{ .Site.Params.twitter }}" />
<meta name="twitter:creator" content="@{{ .Site.Params.twitter }}" />
<meta name="twitter:title" content="{{ .Title }}" />
<meta name="twitter:url" content="{{ .Permalink }}" />
{{ end }}

{{ define "header-image" }}
{{ $eyecatch_image := findRE "<img.*?src=([^>]*)?>" .Content 1 }}
{{ range $eyecatch_image }}
<meta property="og:image" content="{{ . | replaceRE ".*src=\"([^\"]+)\".*" "$1" | absURL}}">
<meta property="twitter:image" content="{{ . | replaceRE ".*src=\"([^\"]+)\".*" "$1" | absURL}}">
{{ end }}
{{ end }}

{{ define "main" }}
<article class="container">
	<header class="column is-full">
		{{ partial "article-header.html" . }}
	</header>

	<div class="columns is-desktop">
		<div class="column is-two-thirds">
			{{ if le (int (.Date.Format "20060101")) (int ((now.AddDate -1 0 0).Format "20060101")) }}
			<div class="message is-warning is-small">
				<div class="message-body">
					この記事は公開されてから1年以上が経過しています。情報が古い可能性がありますのでご注意ください。
				</div>
			</div>
			{{ end }}

			{{ partial "google-adsense1.html" }}

			<div class="markdown-body content">
				{{- .Content -}}
			</div>

			{{ partial "social-share.html" . }}

			{{ partial "google-adsense2.html" }}

			{{ partial "related-posts.html" . }}

			{{ template "_internal/disqus.html" . }}

		</div>
		<!-- main -->

		<aside class="column is-hidden-mobile">
			{{- partial "toc.html" . -}}
		</aside>
		<!-- sidebar -->
	</div>
</article>
{{ end }}
