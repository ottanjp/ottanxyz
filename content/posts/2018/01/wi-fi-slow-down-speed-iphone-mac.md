---
author: ["@ottanxyz"]
date: 2018-01-28 03:49:13+00:00
draft: false
title: iPhoneやMacでWi-Fiの「体感速度」が遅く読み込みに時間がかかる場合の対処法
type: post
slug: wi-fi-slow-down-speed-iphone-mac-6585
categories:
- iPhone
- Mac
tags:
- Wi-Fi
---

![](/uploads/2018/01/180126-5a6b30c618a6f.jpg)

[AirMac（Express、Extreme、Time Capsule）の Wi-Fiの「体感の」速度が遅い問題を見直す](/posts/2018/01/airmac-express-extreme-time-capsule-wifi-speed-slow-6529/)で、AirMacにおける「体感」速度が遅い場合の問題についてご紹介しましたが、この「体感」速度が遅い原因は他にも色々考えられます。今回は、実際に筆者の自宅で体験した例と改善策の例をご紹介します。

![](/uploads/2018/01/180127-5a6c858497735.png)

## Wi-Fiの体感速度が遅い問題を解決する

筆者の自宅では、冒頭の記事でもご紹介しているように、NURO光（戸建プラン）を使用しています。ベストエフォート型の下り最大2Gbps、上り最大1Gbpsと、提供地域は限られているものの、なかなか他に例を見ない理論値のプロバイダーです。確かに、速度測定サイト等で測定すると、実効速度は無線LAN使用時（IEEE802.11ac、1300Mbps）で常時200〜300Mbps程度出ているため、おそらく十分な速度が出ていると思われます。しかし、それにもかかわらず、

-   iPhoneやMacのSafariやChromeで閲覧中にWebページが表示されるまでに時間がかかる（厳密には、読み込みは一瞬だが、読み込みが始まるまでの時間が長い）
-   アプリ起動中に、インターネット接続が発生する場合に表示されるまでに時間がかかる

などの症状が発生することがあります。実効速度が十分であることを鑑みると、iPhoneやMacの性能問題、Wi-Fiネットワークのチャンネル同士の干渉、Wi-Fiのノイズ増（この2つは、2.4GHz帯域を使用している場合は発生する可能性が多い）、などなど、Wi-Fiネットワーク自体に問題が発生しているとは考えづらいです。

### NURO光から提供されているルーターのDNSプロキシを変更する

DNSプロキシ機能は、ブロードバンドルーターに実装されており、クライアント側（たとえば、iPhoneやMac）はブロードバンドルーターのIPアドレス（IPv4/IPv6）をDNSサーバとして設定しておくことによって、ブロードバンドルーターが変わりにプロバイダーから提供されているDNSサーバに対して名前解決を行う機能です。プロバイダーから提供されているDNSサーバが動的に変化する場合に便利な機能ですが、そのようなプロバイダーは皆無でしょう。

そもそも、名前解決（Domain Name System）とは、たとえば弊サイトのドメイン（`ottan.xyz`）を、TCP/IPネットワークで通信可能なIPアドレスに変換するサービスです。クライアント側は、相手先のIPアドレスを知らなくても、ドメイン名さえ把握していれば、DNSにより自動的にIPアドレスに変更され、通信可能な状態になります。調査の過程で、NURO光で提供されているONU兼ルーターには、DNSプロキシの動作が不安定であることがわかりました。詳細なパケットキャプチャ（TCP/UDPダンプ）等を取得したわけではありませんので、必ずしも原因がこれとは限りませんが（なぜか、`dig`コマンド等の実行結果や、`ping`が異常値を示す）。

#### F660シリーズのDNSプロキシの設定変更例

今回は、NURO光で提供されているONU兼ルーターのDNSプロキシを変更する方法をご紹介します。冒頭でご紹介した[AirMac（Express、Extreme、Time Capsule）の Wi-Fiの「体感の」速度が遅い問題を見直す](/posts/2018/01/airmac-express-extreme-time-capsule-wifi-speed-slow-6529/)においても、AirMacをブリッジモードとして使用している場合も、DNSサーバにブロードバンドルーターのIPアドレスを指定する代わりに、プロバイダーが提供されているIPアドレスを直接指定することで事象が解決する可能性もあります（AirMacの原因は別にありそうな気もしますが…）。

![](/uploads/2018/01/180128-5a6d41f30f6bc.png)

Safari等のブラウザから、F660T/AのIPアドレスにアクセスします（デフォルトでは、`192.168.1.1`）。ログイン画面が表示されるため、ユーザー名、パスワードを入力し、ログインします（デフォルトでは、ユーザー名、パスワード共に`admin`です。ログイン後に必ず変更しておきましょう）。

![](/uploads/2018/01/180128-5a6d41fc6fe25.png)

メニューの「アプリケーション」→「DNSサービス」→「DNS」を開きます。「IPv4 DNSサーバー1」「IPv4 DNSサーバー2」「IPv6 DNSサーバー1」「IPv6 DNSサーバー2」にプロバイダーが提供されているIPアドレスを指定し、「設定」ボタンをクリックします（プロバイダーによっては、IPv6 DNSサーバーは提供されていないかもしれません）。

![](/uploads/2018/01/180128-5a6d421db3dbd.png)

次に、「ネットワーク」→「LAN」→「ダイナミックアドレス管理（IPv4）」を開きます。「アプリケーション：DNSサービスの設定を優先にする」をチェックし、「設定」ボタンをクリックします。

![](/uploads/2018/01/180128-5a6d4227f2a29.png)

次に、「ネットワーク」→「LAN」→「ダイナミックアドレス管理（IPv6）」を開きます。「アプリケーション：DNSサービスの設定を優先にする」をチェックし、「設定」ボタンをクリックします。以上で、設定は完了です。クライアント側（iPhoneやMac側）の設定を変更する必要はありません。

### クライアント側で設定が変更されたことを確認する

まず、iPhone側で設定が変更されていることを確認します。

![](/uploads/2018/01/180128-5a6d459e52c8f.png)

「設定」→「Wi-Fi」を開き、接続しているWi-Fiネットワークの隣の\_\_アイコンをタップします。

![](/uploads/2018/01/180128-5a6d45a5ac683.png)

Wi-Fiの設定から「DNSを構成」（デフォルトでは「自動」）をタップします。DNSサーバの一覧に先ほど設定したプロバイダーから提供されているDNSサーバーのIPアドレス一覧が表示されていることを確認します（プロバイダーのDNSサーバーが上位に表示されていることを確認します）。

![](/uploads/2018/01/180128-5a6d45edc8f3f.png)

続いて、Mac側で確認する方法です。「システム環境設定」→「ネットワーク」を開き、「詳細」ボタンをクリックします。

![](/uploads/2018/01/180128-5a6d45f5eaab5.png)

DNSタブに先ほど設定したプロバイダーから提供されているDNSサーバーのIPアドレス一覧が表示されていることを確認します（プロバイダーのDNSサーバーが上位に表示されていることを確認します）。

## まとめ

ONU兼ルーターの設定を変更することで、劇的にページの読み込みやアプリの起動が早くなりました。クライアント側のDNSサーバーを個別に設定変更することでも対処可能ですが、「Bonjour」サービス等が使用できなくなる可能性（同一Wi-Fiネットワーク内の他の機器の名前解決ができなくなる）がありますので、ルーター側のDNSプロキシの設定変更が有効です。
